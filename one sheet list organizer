import pandas as pd
import glob

# Function to concatenate and process Excel files with one sheet
def concatenate_and_process_one_sheet(files):
    result = []
    for file in files:
        # Load the Excel file
        df = pd.read_excel(file)
        
        # Concatenate the first three columns
        concatenated_columns = df.iloc[:, 0] + df.iloc[:, 1] + df.iloc[:, 2]
        
        result.extend(concatenated_columns.tolist())
    
    return result

# List all Excel files for dataset NWM
excel_files_nwm = glob.glob("nwm/*.xlsx")  # Replace "nwm" with the appropriate directory name for NWM dataset

# List all Excel files for dataset OSoc
excel_files_osoc = glob.glob("osoc/*.xlsx")  # Replace "osoc" with the appropriate directory name for OSoc dataset

# Process dataset NWM
datasets_one_sheet_nwm = concatenate_and_process_one_sheet(excel_files_nwm)

# Export dataset NWM as CSV
df_one_sheet_nwm = pd.DataFrame(datasets_one_sheet_nwm)
df_one_sheet_nwm.to_csv("joined_dataset_one_sheet_nwm.csv", index=False)

# Process dataset OSoc
datasets_one_sheet_osoc = concatenate_and_process_one_sheet(excel_files_osoc)

# Export dataset OSoc as CSV
df_one_sheet_osoc = pd.DataFrame(datasets_one_sheet_osoc)
df_one_sheet_osoc.to_csv("joined_dataset_one_sheet_osoc.csv", index=False)